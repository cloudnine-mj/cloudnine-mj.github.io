---
key: jekyll-text-theme
title: 'K8s ì‹¤ìŠµ ê³¼ì œ2'
excerpt: ' Docker/K8s ê³µë¶€í•˜ê¸°ğŸ˜'
tags: [K8s]
---


# ì‹¤ìŠµ ê³¼ì œ

## 16ì£¼ì°¨ ê³¼ì œ

### ì§„í–‰ë‹¨ê³„
* `Chapter08 ë°±ì—… ë° ë³µêµ¬` ìˆ˜ê°•
* 2021ë…„ 11ì›” 23ì¼ (í™”)ê¹Œì§€ ì´ë©”ì¼ ì œì¶œ
* êµ¬ê¸€ formì— `ë³µêµ¬ ìº¡ì²˜ ì‚¬ì§„`ì„ ì²¨ë¶€í•˜ì—¬ ì œì¶œ


### ê³¼ì œ ì„¤ëª…

**ë°±ì—… ë° ë³µêµ¬**

* ë§ˆìŠ¤í„° ë…¸ë“œì— snapshot íŒŒì¼ ë‹¤ìš´ë¡œë“œ, í•´ë‹¹ íŒŒì¼ë¡œ ë³µêµ¬
* ë³µêµ¬ í›„ íŒŒë“œ ìƒíƒœë¥¼ ì¡°íšŒ, í™”ë©´ ìº¡ì²˜í•˜ì—¬ ì œì¶œ
  * 3ê°œì˜ ë§ˆìŠ¤í„° ë…¸ë“œ ì¤‘ 1ê°œë§Œ ë³µêµ¬ ì™„ë£Œí•˜ì—¬ë„ í†µê³¼ ì¸ì •
* íŒíŠ¸
  * ìŠ¤íƒœí‹± íŒŒë“œì˜ ë³¼ë¥¨ ìˆ˜ì •
  * í˜„ì¬ ê°ì í™˜ê²½ì— ì„¤ì¹˜ë˜ì–´ ì‹¤í–‰ì¤‘ì¸ `etcd config`

### ì‘ì—…

* `snapshot-pre-boot.db` íŒŒì¼ ë§ˆìŠ¤í„° ë…¸ë“œì— ë‹¤ìš´ë¡œë“œ
  * `$ wget http://172.30.5.154/snapshot-pre-boot.db`
* ë³µêµ¬
  * `$ sudo su -`
    * ë£¨íŠ¸ ê¶Œí•œìœ¼ë¡œ í•˜ì§€ ì•Šì€ ê²½ìš° ì•ˆë¨..
  * `$ ETCDCTL_API=3 etcdctl --endpoints=https://172.30.5.108:2379 --cacert=/etc/kubernetes/pki/etcd/ca.crt --name=master --cert=/etc/kubernetes/pki/etcd/server.crt --key=/etc/kubernetes/pki/etcd/server.key --data-dir /var/lib/etcd-why-backup --initial-cluster=master=https://127.0.0.1:2380 --initial-cluster-token etcd-cluster-1 --initial-advertise-peer-urls=https://127.0.0.1:2380 snapshot restore /tmp/snapshot-pre-boot.db`
* `etcd.yaml` íŒŒì¼ì—ì„œ ê²½ë¡œ ìˆ˜ì •
  * `$ sudo vi /etc/kubernetes/manifests/etcd.yaml`
  * `- hostPath:`
    * `path: /var/lib/etcd-why-backup`
* ê¸°ì¡´ etcd ë””ë ‰í„°ë¦¬ ì‚­ì œ
  * `$ sudo rm -rf /var/lib/etcd`